// createPrompts creates and returns all MCP prompt definitions with their handlers.
// It also populates global cached metadata for resource handlers.
//
// This function defines the available MCP prompts for certificate analysis workflows.
// Each prompt provides a structured approach to common certificate-related tasks,
// including analysis, monitoring, auditing, and troubleshooting.
//
// Returns:
//   - []server.ServerPrompt: Slice of server prompt definitions with their handlers
//
// The defined prompts are:
{{- range .Prompts}}
//   - {{.Name}}: {{.Description}}
{{- end}}
//
// These prompts guide users through systematic approaches to certificate management
// and provide context-specific instructions for using MCP tools effectively.
func createPrompts() []server.ServerPrompt {
	// Get server cache for storing metadata
	cache := getServerCache()
	cache.prompts = make([]map[string]any, 0, {{len .Prompts}})

	prompts := []server.ServerPrompt{
{{- range .Prompts}}
		{
			Prompt: func() mcp.Prompt {
				prompt := mcp.NewPrompt(
					"{{.Name}}",
					mcp.WithPromptDescription("{{.Description}}"),
{{- range .Arguments}}
					mcp.WithArgument(
						"{{.Name}}",
						mcp.ArgumentDescription("{{.Description}}"),
{{- if .Required}}
						mcp.RequiredArgument(),
{{- end}}
					),
{{- end}}
				)
{{- if .Meta}}
				prompt.Meta = mcp.NewMetaFromMap({{.Meta | toGoMap}})
{{- end}}
				return prompt
			}(),
			Handler: {{.Handler}},
		},
{{- end}}
	}

	// Extract metadata from created prompts for resource handlers
	populatePromptMetadataCache(cache, prompts)

	return prompts
}
