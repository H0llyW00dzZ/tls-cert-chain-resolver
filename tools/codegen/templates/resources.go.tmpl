// createResources creates and returns all MCP resources without adding them to a server.
// It also populates global cached metadata for resource handlers.
//
// This allows for easier testing of resource creation logic and resource definition validation.
//
// Returns:
//   - A slice of server.ServerResource containing all static and dynamic resources
//
// The function defines the following resources:
{{- range .Resources}}
//   - {{.URI}}: {{.Description}}
{{- end}}
//
// These resources provide static content and metadata to MCP clients. Each resource
// includes a URI, name, description, MIME type, and handler function.
func createResources() []server.ServerResource {
	// Get server cache for storing metadata
	cache := getServerCache()
	cache.resources = make([]map[string]any, 0, {{len .Resources}})

	resources := []server.ServerResource{
{{- range .Resources}}
		{
			Resource: func() mcp.Resource {
				res := mcp.NewResource(
					"{{.URI}}",
					"{{.Name}}",
					mcp.WithResourceDescription("{{.Description}}"),
					mcp.WithMIMEType("{{.MIMEType}}"),
{{- if .Audience}}
					mcp.WithAnnotations(
						[]mcp.Role{
{{- range .Audience}}
							mcp.Role{{. | title}},
{{- end}}
					}, {{if .Priority}}{{.Priority}}{{else}}0.0{{end}}),
{{- end}}
				)
{{- if .Meta}}
				res.Meta = mcp.NewMetaFromMap({{.Meta | toGoMap}})
{{- end}}
				return res
			}(),
			Handler: {{.Handler}},
		},
{{- end}}
	}

	// Extract metadata from created resources for resource handlers
	populateResourceMetadataCache(cache, resources)

	return resources
}
